import { useEffect, useRef } from "react";
import { gsap } from "gsap";
import Lenis from "@studio-freight/lenis";

import { ScrollTrigger } from "gsap/ScrollTrigger";

export default function NavBar({ sectionRefs }) {
  const navBar = useRef(null);
  const logo = useRef(null);
  const cta = useRef(null);
  const tl = gsap.timeline();
  gsap.registerPlugin(ScrollTrigger);

  useEffect(() => {
    const lenis = new Lenis();
    function raf(time) {
      lenis.raf(time);
      requestAnimationFrame(raf);
    }
    requestAnimationFrame(raf);
  });

  useEffect(() => {
    tl.to(navBar.current, {
      y: 0,
      duration: 3,
      delay: 0.5,
      ease: "power4.inOut",
    });
  });


  useEffect(() => {
    sectionRefs.forEach((section) => {
      ScrollTrigger.create({
        trigger: section,
        start: "top 375px",
        end: "bottom 300px",
        // markers: true,
        animation: gsap
          .timeline()
          .to(navBar.current, { color: "#DDDDD5" })
          .to(cta.current, { backgroundColor: "#D1D1C7", color: "#0E0E0C" }, 0)
          .to(".bg-secondary-100", { backgroundColor: "#0E0E0C" }, 0),

        toggleActions: "restart reverse restart reverse",
      });
    });

  });

  return (
    <header
      ref={navBar}
      className="fixed top-0 z-50 flex w-full -translate-y-full items-center justify-between bg-secondary-100 px-5 py-3"
    >
      {/* logo */}
      <a href="#hero" aria-label="Logo" className="z-50">
        <svg
          ref={logo}
          width="80"
          height="45"
          viewBox="0 0 121 45"
          fill="currentColor"
          xmlns="http://www.w3.org/2000/svg"
        >

          <path d="M 70.224 11.088 L 69.454 14.96 L 64.614 14.96 L 61.93 4.092 L 66.242 4.092 L 66.726 8.734 L 67.078 12.562 L 67.738 8.756 L 68.64 4.092 L 72.996 4.092 L 73.986 8.756 L 74.602 12.562 L 74.954 8.734 L 75.438 4.092 L 79.75 4.092 L 77.066 14.96 L 72.226 14.96 L 71.456 11.088 L 70.84 6.512 L 70.224 11.088 Z M 11.066 9.79 A 10.111 10.111 0 0 1 10.927 11.07 Q 10.812 11.721 10.609 12.264 A 5.161 5.161 0 0 1 10.373 12.804 A 4.333 4.333 0 0 1 9.607 13.886 A 3.742 3.742 0 0 1 8.701 14.564 A 4.664 4.664 0 0 1 7.365 15.027 Q 6.802 15.134 6.159 15.136 A 7.782 7.782 0 0 1 6.138 15.136 Q 4.51 15.136 3.113 14.355 A 5.235 5.235 0 0 1 1.455 12.871 A 6.991 6.991 0 0 1 0.858 11.902 A 7.039 7.039 0 0 1 0.279 10.282 Q 0 9.086 0 7.568 A 9.222 9.222 0 0 1 0.228 5.475 A 7.431 7.431 0 0 1 0.913 3.641 Q 1.826 1.936 3.564 0.968 A 7.404 7.404 0 0 1 5.749 0.185 Q 6.659 0.006 7.699 0 A 12.451 12.451 0 0 1 7.766 0 A 9.927 9.927 0 0 1 9.461 0.139 A 8.083 8.083 0 0 1 10.659 0.44 A 7.382 7.382 0 0 1 12.264 1.195 A 6.488 6.488 0 0 1 12.936 1.683 Q 13.904 2.486 14.432 3.586 L 11.132 6.204 Q 10.978 5.522 10.527 4.983 A 3.062 3.062 0 0 0 9.553 4.217 A 3.606 3.606 0 0 0 9.383 4.136 A 3.472 3.472 0 0 0 8.53 3.887 A 4.73 4.73 0 0 0 7.766 3.828 A 4.699 4.699 0 0 0 6.897 3.904 Q 6.379 4.002 5.959 4.224 A 2.857 2.857 0 0 0 5.841 4.29 Q 5.06 4.752 4.675 5.588 A 4.036 4.036 0 0 0 4.375 6.563 Q 4.29 7.032 4.29 7.568 A 5.935 5.935 0 0 0 4.36 8.504 Q 4.442 9.018 4.621 9.445 A 3.361 3.361 0 0 0 4.73 9.68 A 3.199 3.199 0 0 0 5.383 10.561 A 2.915 2.915 0 0 0 5.951 10.978 Q 6.732 11.418 7.744 11.418 A 5.096 5.096 0 0 0 8.416 11.376 Q 8.772 11.329 9.077 11.228 A 3.04 3.04 0 0 0 9.163 11.198 A 3.21 3.21 0 0 0 10.104 10.67 A 3.043 3.043 0 0 0 10.219 10.571 Q 10.67 10.164 10.956 9.658 L 11.11 9.658 L 11.066 9.79 L 11.902 14.96 L 14.586 14.96 L 14.586 6.71 L 7.15 6.71 L 7.15 9.79 L 11.066 9.79 Z M 61.116 10.582 L 53.218 10.582 L 53.218 8.536 L 58.212 8.536 L 57.684 8.778 A 3.632 3.632 0 0 0 57.645 8.23 Q 57.602 7.943 57.508 7.712 A 1.589 1.589 0 0 0 57.288 7.326 Q 56.977 6.928 56.311 6.843 A 3.062 3.062 0 0 0 55.924 6.82 A 2.454 2.454 0 0 0 55.36 6.881 A 1.643 1.643 0 0 0 54.571 7.304 Q 54.152 7.714 54.088 8.47 A 3.375 3.375 0 0 0 54.076 8.756 L 54.076 9.966 A 3.074 3.074 0 0 0 54.111 10.445 Q 54.178 10.869 54.373 11.165 Q 54.67 11.616 55.187 11.814 A 2.98 2.98 0 0 0 55.918 11.989 A 3.742 3.742 0 0 0 56.342 12.012 A 4.285 4.285 0 0 0 56.831 11.985 Q 57.089 11.956 57.314 11.893 A 2.676 2.676 0 0 0 57.321 11.891 Q 57.75 11.77 58.091 11.495 Q 58.432 11.22 58.63 10.758 L 61.028 13.046 A 4.833 4.833 0 0 1 60.286 13.819 Q 59.916 14.131 59.454 14.416 A 8.458 8.458 0 0 1 59.279 14.52 Q 58.146 15.18 56.276 15.18 A 8.04 8.04 0 0 1 54.851 15.06 Q 53.879 14.885 53.108 14.454 Q 51.81 13.728 51.139 12.452 A 5.82 5.82 0 0 1 50.527 10.473 A 7.372 7.372 0 0 1 50.468 9.526 Q 50.468 7.876 51.139 6.6 Q 51.81 5.324 53.031 4.598 A 5.127 5.127 0 0 1 54.913 3.943 A 6.681 6.681 0 0 1 55.902 3.872 Q 57.356 3.872 58.384 4.311 A 4.063 4.063 0 0 1 58.938 4.598 Q 60.104 5.324 60.665 6.49 Q 61.226 7.656 61.226 8.976 A 11.34 11.34 0 0 1 61.22 9.344 Q 61.214 9.531 61.202 9.738 A 19.046 19.046 0 0 1 61.193 9.878 A 13.1 13.1 0 0 1 61.176 10.11 Q 61.149 10.433 61.116 10.582 Z M 39.402 13.53 L 40.876 10.67 Q 41.514 11.088 42.295 11.462 A 9.834 9.834 0 0 0 43.662 11.999 A 8.972 8.972 0 0 0 43.857 12.056 A 6.289 6.289 0 0 0 44.585 12.218 A 4.598 4.598 0 0 0 45.298 12.276 A 2.832 2.832 0 0 0 45.528 12.267 Q 45.8 12.245 45.958 12.166 A 0.475 0.475 0 0 0 46.072 12.089 A 0.332 0.332 0 0 0 46.178 11.836 Q 46.178 11.594 45.859 11.44 A 2.455 2.455 0 0 0 45.667 11.359 Q 45.331 11.231 44.704 11.066 L 43.208 10.67 A 12.945 12.945 0 0 1 42.307 10.384 Q 41.766 10.189 41.327 9.966 A 3.486 3.486 0 0 1 40.717 9.577 A 2.61 2.61 0 0 1 40.15 8.954 A 2.422 2.422 0 0 1 39.82 8.122 A 3.417 3.417 0 0 1 39.754 7.436 A 3.518 3.518 0 0 1 39.944 6.252 A 2.947 2.947 0 0 1 41.052 4.818 A 4.65 4.65 0 0 1 42.551 4.129 Q 43.189 3.956 43.944 3.911 A 9.291 9.291 0 0 1 44.506 3.894 A 10.321 10.321 0 0 1 45.885 3.981 Q 46.829 4.109 47.586 4.422 A 15.197 15.197 0 0 1 48.313 4.744 Q 49.059 5.099 49.5 5.434 L 48.158 8.25 Q 47.102 7.48 46.024 7.128 Q 45.199 6.859 44.528 6.795 A 4.226 4.226 0 0 0 44.132 6.776 A 2.298 2.298 0 0 0 43.915 6.786 Q 43.659 6.81 43.516 6.897 A 0.498 0.498 0 0 0 43.412 6.98 A 0.333 0.333 0 0 0 43.318 7.216 A 0.359 0.359 0 0 0 43.406 7.448 Q 43.488 7.549 43.648 7.634 A 2.171 2.171 0 0 0 43.827 7.717 Q 44.12 7.84 44.672 8.01 A 26.137 26.137 0 0 0 45.034 8.118 L 46.156 8.448 Q 47.916 8.954 48.807 9.702 A 2.445 2.445 0 0 1 49.672 11.333 A 3.512 3.512 0 0 1 49.698 11.77 A 3.149 3.149 0 0 1 49.507 12.88 A 2.893 2.893 0 0 1 49.148 13.552 A 3.363 3.363 0 0 1 48.138 14.475 A 4.345 4.345 0 0 1 47.597 14.751 Q 46.691 15.139 45.453 15.176 A 8.869 8.869 0 0 1 45.188 15.18 A 11.629 11.629 0 0 1 43.382 15.044 A 10.236 10.236 0 0 1 42.812 14.938 Q 41.69 14.696 40.821 14.322 A 9.095 9.095 0 0 1 40.214 14.035 Q 39.907 13.875 39.653 13.708 A 4.653 4.653 0 0 1 39.402 13.53 Z M 96.162 12.364 L 96.162 14.96 L 92.202 14.96 L 92.202 0.22 L 96.162 0.22 L 96.162 4.994 L 95.942 8.712 L 98.186 5.764 L 99.66 4.092 L 104.236 4.092 L 98.67 10.032 L 98.186 10.098 L 96.162 12.364 Z M 91.212 11.946 L 91.212 14.96 L 88.968 14.96 Q 88.352 14.96 87.791 14.762 Q 87.23 14.564 86.878 14.113 A 1.557 1.557 0 0 1 86.61 13.568 Q 86.526 13.268 86.526 12.892 L 86.526 9.636 L 86.702 9.086 A 7.474 7.474 0 0 0 86.688 8.616 Q 86.659 8.151 86.567 7.85 A 1.403 1.403 0 0 0 86.482 7.634 A 0.642 0.642 0 0 0 86.192 7.353 Q 85.946 7.226 85.532 7.2 A 3.537 3.537 0 0 0 85.316 7.194 A 4.182 4.182 0 0 0 83.945 7.433 A 5.201 5.201 0 0 0 83.402 7.656 Q 82.434 8.118 81.752 8.888 L 79.992 5.984 A 8.106 8.106 0 0 1 81.399 4.97 A 9.042 9.042 0 0 1 81.532 4.895 A 8.331 8.331 0 0 1 83.152 4.219 A 9.342 9.342 0 0 1 83.402 4.147 A 7.997 7.997 0 0 1 85.257 3.876 A 8.992 8.992 0 0 1 85.536 3.872 A 6.838 6.838 0 0 1 86.869 3.994 Q 87.671 4.154 88.296 4.521 A 3.781 3.781 0 0 1 88.836 4.906 A 3.277 3.277 0 0 1 89.854 6.532 Q 90.01 7.073 90.039 7.724 A 6.824 6.824 0 0 1 90.046 8.03 L 90.046 11.308 A 1.629 1.629 0 0 0 90.054 11.471 Q 90.071 11.642 90.127 11.745 A 0.353 0.353 0 0 0 90.167 11.803 A 0.36 0.36 0 0 0 90.315 11.905 Q 90.375 11.928 90.449 11.938 A 0.933 0.933 0 0 0 90.574 11.946 L 91.212 11.946 Z M 16.28 11.704 L 16.28 4.092 L 20.24 4.092 L 20.24 10.164 A 5.729 5.729 0 0 0 20.264 10.71 Q 20.317 11.255 20.482 11.605 A 1.545 1.545 0 0 0 20.515 11.671 Q 20.739 12.091 21.362 12.17 A 2.466 2.466 0 0 0 21.67 12.188 A 2.997 2.997 0 0 0 21.994 12.172 Q 22.335 12.135 22.548 12.013 A 0.882 0.882 0 0 0 22.55 12.012 Q 22.858 11.836 22.979 11.363 A 3.042 3.042 0 0 0 23.042 11.032 Q 23.092 10.677 23.099 10.177 A 11.954 11.954 0 0 0 23.1 10.01 L 23.166 11.264 Q 23.056 12.254 22.671 13.145 Q 22.286 14.036 21.527 14.608 A 2.702 2.702 0 0 1 20.556 15.063 Q 20.181 15.158 19.742 15.176 A 5.055 5.055 0 0 1 19.536 15.18 A 4.218 4.218 0 0 1 18.705 15.102 A 3.083 3.083 0 0 1 17.798 14.773 A 2.747 2.747 0 0 1 16.682 13.597 A 3.317 3.317 0 0 1 16.676 13.585 A 3.512 3.512 0 0 1 16.367 12.665 Q 16.28 12.22 16.28 11.704 Z M 27.06 4.092 L 27.06 14.96 L 23.1 14.96 L 23.1 4.092 L 27.06 4.092 Z M 32.78 4.092 L 32.78 14.96 L 28.82 14.96 L 28.82 4.092 L 32.78 4.092 Z M 32.78 9.482 A 5.784 5.784 0 0 1 32.79 9.144 Q 32.808 8.833 32.861 8.564 A 2.87 2.87 0 0 1 33.022 8.019 Q 33.264 7.436 33.671 7.15 A 1.792 1.792 0 0 1 33.854 7.037 A 1.388 1.388 0 0 1 34.518 6.864 Q 35.002 6.864 35.211 7.15 A 0.942 0.942 0 0 1 35.28 7.259 Q 35.359 7.405 35.393 7.589 A 1.672 1.672 0 0 1 35.42 7.898 Q 35.42 8.382 35.156 8.943 A 5.631 5.631 0 0 1 35.081 9.097 Q 34.849 9.554 34.584 9.856 L 38.214 9.856 A 2.823 2.823 0 0 0 38.249 9.793 Q 38.474 9.381 38.709 8.646 A 5.113 5.113 0 0 0 38.895 7.832 A 6.663 6.663 0 0 0 38.962 6.864 A 5.792 5.792 0 0 0 38.947 6.439 Q 38.914 5.987 38.807 5.604 A 2.891 2.891 0 0 0 38.379 4.686 Q 37.958 4.098 37.094 3.935 A 3.93 3.93 0 0 0 36.366 3.872 Q 35.464 3.872 34.804 4.268 Q 34.144 4.664 33.715 5.313 Q 33.286 5.962 33.044 6.721 A 8.823 8.823 0 0 0 33.029 6.768 A 8.031 8.031 0 0 0 32.714 8.228 L 32.78 9.482 Z M 83.71 8.976 L 86.878 8.008 L 87.164 10.274 L 84.744 11.132 Q 84.336 11.279 84.128 11.414 A 0.851 0.851 0 0 0 84.007 11.506 A 0.664 0.664 0 0 0 83.893 11.644 A 0.488 0.488 0 0 0 83.82 11.902 A 0.53 0.53 0 0 0 83.851 12.088 Q 83.901 12.221 84.029 12.309 A 0.687 0.687 0 0 0 84.211 12.395 Q 84.392 12.452 84.656 12.452 A 3.999 3.999 0 0 0 85.028 12.436 Q 85.217 12.418 85.381 12.381 A 2.174 2.174 0 0 0 85.492 12.353 Q 85.844 12.254 86.075 12.056 Q 86.306 11.858 86.416 11.55 A 1.792 1.792 0 0 0 86.498 11.22 Q 86.522 11.061 86.526 10.88 A 3.093 3.093 0 0 0 86.526 10.824 L 86.57 11.858 Q 86.416 12.584 86.053 13.354 Q 85.69 14.124 84.997 14.663 A 2.409 2.409 0 0 1 84.142 15.08 Q 83.806 15.171 83.409 15.194 A 4.694 4.694 0 0 1 83.138 15.202 A 3.674 3.674 0 0 1 82.136 15.071 A 2.944 2.944 0 0 1 81.125 14.564 A 1.96 1.96 0 0 1 80.475 13.633 Q 80.358 13.296 80.319 12.879 A 4.632 4.632 0 0 1 80.3 12.452 A 3.519 3.519 0 0 1 80.421 11.504 A 2.632 2.632 0 0 1 81.103 10.329 Q 81.906 9.526 83.71 8.976 Z M 99.924 8.206 L 104.148 14.96 L 99.726 14.96 L 96.756 9.482 L 99.924 8.206 Z"/>
          
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M113.5 1.5H111V6.50001H113.5C112.119 6.50001 111 7.61931 111 9.00001V11.5H116V9.00001C116 10.3807 117.119 11.5 118.5 11.5H121V6.50001H118.5C119.881 6.50001 121 5.38072 121 4V1.5H116V4C116 2.61929 114.881 1.5 113.5 1.5ZM116 6.50001H113.5C114.881 6.50001 116 7.61931 116 9.00001V6.50001ZM116 6.50001V4C116 5.38072 117.119 6.50001 118.5 6.50001H116Z"
          />
        </svg>
      </a>
      <nav className=" space-x-7 font-grotesk text-body-3 sm:block">
        <a href="#about" className="group relative hidden md:inline-block">
          <span>about</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a href="#services" className="group relative hidden md:inline-block">
          <span>services</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a href="#works" className="group relative hidden md:inline-block">
          <span>projects</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a
          ref={cta}
          className="button group relative hover:bg-transparent"
          href="#contact"
        >
          <span className="relative w-fit">
            <span className="absolute bottom-2 h-[0.15em] w-0 bg-secondary-700 opacity-90 duration-300 ease-out group-hover:w-full"></span>
            <span>Let&apos;s Talk.</span>
          </span>
        </a>
      </nav>
    </header>
  );
}
